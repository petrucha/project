<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:body>
	<ui:composition>

		<h:form>

			<h:panelGroup id="chart">

				<p:chart type="line" model="#{chartsViewBean.lineModel}"
					rendered="#{chartsViewBean.chartType eq 'line'}"
					style="height:400px;width:98%;" id="lineChart" responsive="true" />

				<p:chart type="bar" model="#{chartsViewBean.barModel}"
					rendered="#{chartsViewBean.chartType eq 'bar'}"
					style="height:400px;width:98%;" id="barChart" responsive="true" />

				<p:chart type="pie" model="#{chartsViewBean.pieModel}"
					rendered="#{chartsViewBean.chartType eq 'pie'}"
					style="height:400px;widht:98%" id="pieChart" responsive="true" />

			</h:panelGroup>

			<p:remoteCommand name="refrCharts" update="chart"
				actionListener="#{chartsViewBean.initChart()}" />

			<p:toolbar id="tb">

				<f:facet name="left">

					<p:tabView>

						<p:tab title="#{msg['graph.tabs.general']}">
							<h:panelGrid columns="2" cellpadding="2">
								<h:outputText value="#{msg['graph.records.type']}" />
								<p:selectOneButton value="#{chartsViewBean.recordsType}">
									<f:selectItem itemLabel="#{msg['graph.temp']}" itemValue="temp" />
									<f:selectItem itemLabel="Pressure" itemValue="pres" />
									<f:selectItem itemLabel="Humidity" itemValue="humi" />
								</p:selectOneButton>

								<h:outputText value="Chart type :" />
								<p:selectOneButton value="#{chartsViewBean.chartType}">
									<f:selectItem itemLabel="Line chart" itemValue="line" />
									<f:selectItem itemLabel="Bar chart" itemValue="bar" />
									<f:selectItem itemLabel="Pie chart" itemValue="pie" />
								</p:selectOneButton>

								<h:outputText value="Devices :" />
								<p:selectCheckboxMenu id="devicesListBox" class="filters"
									label="Select devices" filter="true"
									value="#{chartsViewBean.selectedDevices}"
									filterMatchMode="startsWith" panelStyle="width:400px">
									<f:selectItems value="#{chartsViewBean.devices}" />
								</p:selectCheckboxMenu>
							</h:panelGrid>
						</p:tab>

						<p:tab title="Bar chart">
							<h:panelGrid columns="2" cellpadding="2">
								<h:outputText value="Limit :" />
								<h:outputText id="output"
									value="Show last #{chartsViewBean.recordsCount} records per device" />
								<h:inputHidden id="txt2" value="#{chartsViewBean.recordsCount}" />
								<p:slider for="txt2" display="output" style="width: 200px"
									displayTemplate="Show last {value} records per device" step="1"
									minValue="1" maxValue="5" />
							</h:panelGrid>
						</p:tab>

						<p:tab title="Line &amp; pie charts">
							<h:panelGrid columns="2" cellpadding="2">
								<h:outputText value="Start date and time :" />
								<p:calendar id="startDate" value="#{chartsViewBean.startDate}"
									pattern="yyyy-MM-dd HH.mm.ss" mask="true" class="filters" />

								<h:outputText value="End date and time :" />
								<p:calendar id="endDate" value="#{chartsViewBean.endDate}"
									pattern="yyyy-MM-dd HH.mm.ss" mask="true" class="filters" />
							</h:panelGrid>
						</p:tab>

					</p:tabView>

				</f:facet>

				<f:facet name="right">
					<h:panelGrid columns="2" cellpadding="2" class="facetRight">
					
						<p:commandButton type="button"
							onclick="refrCharts()" value="Refresh"
							icon="ui-icon-refresh" class="refreshButon"/>

						<p:ajaxStatus onstart="PF('statusDialog').show()"
							onsuccess="PF('statusDialog').hide()" />

						<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
							closable="false" resizable="false" showHeader="false">
							<h:graphicImage library="images" name="ajax-loader.gif" />
						</p:dialog>
						
					</h:panelGrid>
				</f:facet>

			</p:toolbar>

		</h:form>

	</ui:composition>
</h:body>
</html>