<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:body>
	<ui:composition>

		<h:form>

			<h:panelGroup id="chart">

				<p:chart type="line" model="#{chartsViewBean.lineModel}"
					rendered="#{chartsViewBean.chartType eq 'line'}"
					style="height:400px;width:98%;" id="lineChart" responsive="true" />

				<p:chart type="bar" model="#{chartsViewBean.barModel}"
					rendered="#{chartsViewBean.chartType eq 'bar'}"
					style="height:400px;width:98%;" id="barChart" responsive="true" />

				<p:chart type="pie" model="#{chartsViewBean.pieModel}"
					rendered="#{chartsViewBean.chartType eq 'pie'}"
					style="height:400px;widht:98%" id="pieChart" responsive="true" />

			</h:panelGroup>
			
			<p:remoteCommand name="refrCharts" update="chart"
				actionListener="#{chartsViewBean.initChart()}" />

			<p:toolbar id="tb">

				<f:facet name="left">

					<p:tabView>

						<p:tab title="General">
							<h:outputText value="Records type :" />
							<p:selectOneButton value="#{chartsViewBean.recordsType}">
								<f:selectItem itemLabel="Temperature" itemValue="temp" />
								<f:selectItem itemLabel="Pressure" itemValue="pres" />
								<f:selectItem itemLabel="Humidity" itemValue="humi" />
							</p:selectOneButton>

							<h:outputText value="Chart type :" />
							<p:selectOneButton value="#{chartsViewBean.chartType}">
								<f:selectItem itemLabel="Line Chart" itemValue="line" />
								<f:selectItem itemLabel="Last records" itemValue="bar" />
								<f:selectItem itemLabel="Average per device" itemValue="pie" />
							</p:selectOneButton>

							<p:commandButton type="button" onclick="refrCharts()"
								value="Refresh" icon="ui-icon-refresh" class="filters" />
						</p:tab>

						<p:tab title="Bar Chart">
							<h:panelGrid columns="5" cellpadding="1">
								<p:column>
									<h3>Devices:</h3>
								</p:column>
								<p:column>
									<p:selectCheckboxMenu id="menu" class="filters"
										label="Select devices"
										value="#{chartsViewBean.selectedDevices}" filter="true"
										filterMatchMode="startsWith" panelStyle="width:400px">
										<f:selectItems value="#{chartsViewBean.devices}" />
									</p:selectCheckboxMenu>
								</p:column>
								<p:column>
									<h3>Limit:</h3>
								</p:column>
								<p:column>
									<h:outputText id="output"
										value="Show last #{chartsViewBean.recordsCount} records per device" />
									<h:inputHidden id="txt2" value="#{chartsViewBean.recordsCount}" />
									<p:slider for="txt2" display="output" style="width: 200px"
										displayTemplate="Show last {value} records per device"
										step="1" minValue="1" maxValue="5" />
								</p:column>
								<p:column>
									<p:commandButton type="button" onclick="refrCharts()"
										value="Refresh" icon="ui-icon-refresh" class="filters" />
								</p:column>

							</h:panelGrid>
						</p:tab>

						<p:tab title="Line &amp; Average Chart">
							<h:panelGrid columns="4" cellpadding="2">

								<p:column>
									<h3>Start Date and Time:</h3>
									<p:calendar id="startDate" value="#{chartsViewBean.startDate}"
										pattern="dd/MM/yyyy HH:mm:ss" mask="true" class="filters" />
								</p:column>

								<p:column>
									<h3>End Date and Time:</h3>
									<p:calendar id="endDate" value="#{chartsViewBean.endDate}"
										pattern="dd/MM/yyyy HH:mm:ss" mask="true" class="filters" />
								</p:column>

								<p:column>
									<h3>Devices:</h3>
									<p:selectCheckboxMenu id="menu1" class="filters"
										label="Select devices"
										value="#{chartsViewBean.selectedDevices}" filter="true"
										filterMatchMode="startsWith" panelStyle="width:400px">
										<f:selectItems value="#{chartsViewBean.devices}" />
									</p:selectCheckboxMenu>
								</p:column>

								<p:column>
									<p:commandButton type="button" onclick="refrCharts()"
										value="Refresh" icon="ui-icon-refresh" class="filters" />
								</p:column>

							</h:panelGrid>
						</p:tab>

					</p:tabView>

				</f:facet>

			</p:toolbar>

		</h:form>

	</ui:composition>
</h:body>
</html>